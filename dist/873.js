(self.webpackChunkrezfusion_components=self.webpackChunkrezfusion_components||[]).push([[873],{862:(e,t,r)=>{var n=r(8).default;function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}e.exports=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var a={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=u?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a},e.exports.default=e.exports,e.exports.__esModule=!0},8:e=>{function t(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},9997:(e,t,r)=>{"use strict";var n=r(5318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(7294)).default.createContext();t.default=o},3452:(e,t,r)=>{"use strict";var n=r(5318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(7294)).default.createContext();t.default=o},873:(e,t,r)=>{"use strict";var n=r(862),o=r(5318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(r(6156)),u=o(r(484)),i=o(r(4699)),l=n(r(7294)),d=o(r(5697)),s=o(r(381)),f=o(r(3452)),c=o(r(9997)),p=r(6071);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m="\nquery($item_id: String!, $type: Int!, $channels: ChannelFilter!, $params: OrderQuoteFilter!) {\n  orderQuote(item_id:$item_id, type:$type, channels:$channels, params: $params) {\n    total,\n    subtotal,\n    tax,\n    currency,\n    provider,\n    source,\n    charges {\n      name,\n      base,\n      option,\n      accepted,\n      declined,\n    }\n  }\n}\n",h=function(e){var t=e.children,r=e.type,n=e.itemId,o=e.initialDates,d=e.initialGuests,y=e.initialPromoCode,h=(0,l.useState)(!1),v=(0,i.default)(h,2),O=v[0],g=v[1],P=(0,l.useState)(),j=(0,i.default)(P,2),_=j[0],x=j[1],S=(0,l.useState)(o),w=(0,i.default)(S,2),D=w[0],M=w[1],q=(0,l.useState)(d),C=(0,i.default)(q,2),k=C[0],Q=C[1],$=(0,l.useState)(y),I=(0,i.default)($,2),E=I[0],R=I[1],F=(0,l.useState)(),G=(0,i.default)(F,2),W=G[0],z=G[1],A=(0,l.useState)(null),L=(0,i.default)(A,2),J=L[0],N=L[1],T=(0,l.useContext)(c.default).settings.components.SearchProvider,U=T.endpoint,B=T.channels;(0,l.useEffect)((function(){var e,t,r,n,o=new URLSearchParams(window.location.search);if(o.has("availFilter")){var a=JSON.parse(o.get("availFilter"));"object"===(0,u.default)(a)&&(e=a.begin?(0,s.default)(a.begin):null,t=a.end?(0,s.default)(a.end):null,r=parseInt(a.adult,10)||1,n=parseInt(a.child,10)||0)}M({begin:e,end:t}),Q({adult:r,child:n})}),[]);var H=(0,p.formatDate)(D.begin),K=(0,p.formatDate)(D.end),V=k.adult,X=k.child;(0,l.useEffect)((function(){if(x(null),r&&H&&K){g(!0);var e={item_id:n,type:r,channels:{url:B},params:{begin:H,end:K,IDs:(0,a.default)({},r,[n]),adult:V,child:X,coupon:E}};(0,p.fetchData)(m,e,U).then((function(e){return e.json()})).then((function(t){t&&t.data&&t.data.orderQuote?(E?(0,p.fetchData)(m,b(b({},e),{},{params:b(b({},e.params),{},{coupon:void 0})}),U).then((function(e){return e.json()})).then((function(e){if(e&&e.data&&e.data.orderQuote){var r=t.data.orderQuote.total,n=e.data.orderQuote.total;N(r<n)}})).catch((function(e){console.error(e)})):N(null),x(t.data.orderQuote),z(null)):(z("An error occurred while fetching quotes."),console.error("Order quote not found."))})).catch((function(e){console.error(e),z("An error occurred while fetching quotes")})).finally((function(){g(!1)}))}}),[H,K,V,X,E,r,n,B,U]);var Y={itemId:n,type:r,dates:D,setDates:M,guests:k,setGuests:Q,promoCode:E,setPromoCode:R,quoteError:W,quoteLoading:O,orderQuote:_,promoStatus:J};return l.default.createElement(f.default.Provider,{value:Y},t)};t.default=h,h.propTypes={children:d.default.node.isRequired,itemId:d.default.string.isRequired,type:d.default.number.isRequired,initialDates:d.default.shape({begin:d.default.instanceOf(s.default.Moment),end:d.default.instanceOf(s.default.Moment)}),initialGuests:d.default.exact({adult:d.default.number.isRequired,child:d.default.number.isRequired}),initialPromoCode:d.default.string},h.defaultProps={initialDates:{begin:null,end:null},initialGuests:{adult:1,child:0},initialPromoCode:null}}}]);