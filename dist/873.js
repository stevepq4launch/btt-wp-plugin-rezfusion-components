(self.webpackChunkrezfusion_components=self.webpackChunkrezfusion_components||[]).push([[873,997],{862:(e,t,n)=>{var r=n(8).default;function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}e.exports=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var o={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=u?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(o,l,i):o[l]=e[l]}return o.default=e,n&&n.set(e,o),o},e.exports.default=e.exports,e.exports.__esModule=!0},8:e=>{function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},9997:(e,t,n)=>{"use strict";var r=n(5318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7294)).default.createContext();t.default=a},3452:(e,t,n)=>{"use strict";var r=n(5318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(7294)).default.createContext();t.default=a},873:(e,t,n)=>{"use strict";var r=n(862),a=n(5318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(6156)),u=a(n(484)),l=a(n(4699)),i=r(n(7294)),d=a(n(5697)),s=a(n(381)),f=a(n(3452)),c=a(n(9997)),p=n(6071),m=function(e){var t=e.children,n=e.type,r=e.itemId,a=e.initialDates,d=e.initialGuests,m=e.initialPromoCode,y=(0,i.useState)(!1),h=(0,l.default)(y,2),b=h[0],v=h[1],_=(0,i.useState)(),g=(0,l.default)(_,2),x=g[0],O=g[1],P=(0,i.useState)(a),S=(0,l.default)(P,2),M=S[0],w=S[1],j=(0,i.useState)(d),q=(0,l.default)(j,2),C=q[0],D=q[1],$=(0,i.useState)(m),k=(0,l.default)($,2),I=k[0],R=k[1],Q=(0,i.useState)(),E=(0,l.default)(Q,2),F=E[0],G=E[1],W=(0,i.useContext)(c.default).settings.components.SearchProvider,z=W.endpoint,A=W.channels;(0,i.useEffect)((function(){var e,t,n,r,a=new URLSearchParams(window.location.search);if(a.has("availFilter")){var o=JSON.parse(a.get("availFilter"));"object"===(0,u.default)(o)&&(e=o.begin?(0,s.default)(o.begin):null,t=o.end?(0,s.default)(o.end):null,n=parseInt(o.adult,10)||1,r=parseInt(o.child,10)||0)}w({begin:e,end:t}),D({adult:n,child:r})}),[]);var L=(0,p.formatDate)(M.begin),J=(0,p.formatDate)(M.end),N=C.adult,T=C.child;(0,i.useEffect)((function(){if(O(null),n&&L&&J){v(!0);var e={item_id:r,type:n,channels:{url:A},params:{begin:L,end:J,IDs:(0,o.default)({},n,[r]),adult:N,child:T,coupon:I}};(0,p.fetchData)("\nquery($item_id: String!, $type: Int!, $channels: ChannelFilter!, $params: OrderQuoteFilter!) {\n  orderQuote(item_id:$item_id, type:$type, channels:$channels, params: $params) {\n    total,\n    subtotal,\n    tax,\n    currency,\n    provider,\n    source,\n    charges {\n      name,\n      base,\n      option,\n      accepted,\n      declined,\n    }\n  }\n}\n",e,z).then((function(e){return e.json()})).then((function(e){e&&e.data&&e.data.orderQuote?(O(e.data.orderQuote),G(null)):(G("An error occurred while fetching quotes."),console.error("Order quote not found."))})).catch((function(e){console.error(e),G("An error occurred while fetching quotes")})).finally((function(){v(!1)}))}}),[L,J,N,T,I,n,r,A,z]);var U={itemId:r,type:n,dates:M,setDates:w,guests:C,setGuests:D,promoCode:I,setPromoCode:R,quoteError:F,quoteLoading:b,orderQuote:x};return i.default.createElement(f.default.Provider,{value:U},t)};t.default=m,m.propTypes={children:d.default.node.isRequired,itemId:d.default.string.isRequired,type:d.default.number.isRequired,initialDates:d.default.shape({begin:d.default.instanceOf(s.default.Moment),end:d.default.instanceOf(s.default.Moment)}),initialGuests:d.default.exact({adult:d.default.number.isRequired,child:d.default.number.isRequired}),initialPromoCode:d.default.string},m.defaultProps={initialDates:{begin:null,end:null},initialGuests:{adult:1,child:0},initialPromoCode:null}}}]);